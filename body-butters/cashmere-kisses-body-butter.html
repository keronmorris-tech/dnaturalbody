<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Cashmere Kisses | D'NATURAL BODY</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles.css">

  <style>
    /* Hide Shopify Buy Button's built-in selector/price UI (we render our own) */
    #product-component-1771275419576 .shopify-buy__product__variant-selectors,
    #product-component-1771275419576 .shopify-buy__option-select-wrapper,
    #product-component-1771275419576 select.shopify-buy__option-select__select,
    #product-component-1771275419576 .shopify-buy__product__price,
    #product-component-1771275419576 .shopify-buy__product__actual-price,
    #product-component-1771275419576 .shopify-buy__product__compare-price {
      display: none !important;
    }

    /* Custom "size chips" */
    .dn-buybox {
      margin-top: 18px;
      border-top: 1px solid rgba(0,0,0,0.08);
      padding-top: 16px;
    }
    .dn-price {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      font-size: 18px;
      color: #0b0a0a;
      margin: 0 0 12px 0;
    }
    .dn-sizes {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 14px;
    }
    .dn-chip {
      font-family: 'Montserrat', sans-serif;
      font-size: 14px;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.18);
      background: #fff;
      color: #0b0a0a;
      cursor: pointer;
      user-select: none;
      transition: transform 0.05s ease;
    }
    .dn-chip:active { transform: scale(0.98); }
    .dn-chip[aria-pressed="true"]{
      border-color: rgba(0,0,0,0.75);
      box-shadow: 0 0 0 2px rgba(0,0,0,0.08);
      font-weight: 700;
    }

    .dn-row {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-bottom: 10px;
    }
    .dn-qty {
      width: 70px;
      padding: 12px 10px;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.2);
      font-family: 'Montserrat', sans-serif;
      text-align: center;
    }
    .dn-add {
      background: #1d201c;
      color: #fff;
      border: none;
      padding: 14px 18px;
      border-radius: 10px;
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      cursor: pointer;
    }
    .dn-add:hover { background: #313630; }
    .dn-add:disabled { opacity: 0.6; cursor: not-allowed; }
    .dn-note {
      font-family: 'Montserrat', sans-serif;
      font-size: 13px;
      color: rgba(0,0,0,0.65);
      margin-top: 6px;
    }
  </style>
</head>

<body class="product-body">
  <header class="header">
    <a href="../index.html" class="logo">
      <img src="../images/logo.png" alt="D'NATURAL BODY Logo">
    </a>

    <nav class="main-nav">
      <a href="../index.html" class="nav-link">Home</a>

      <div class="nav-item dropdown">
        <a href="../shop.html" class="nav-link">Shop â–¾</a>
        <div class="dropdown-menu">
          <a href="../shop.html">View All</a>
          <a href="../shop-body-butter.html">Body Butter</a>
          <a href="../shop-body-scrub.html">Body Scrub</a>
          <a href="../shop-body-yogurt.html">Body Yogurt</a>
        </div>
      </div>

      <a href="../about.html" class="nav-link">About</a>
      <a href="../contact.html" class="nav-link">Contact</a>

      <button class="cart-button" id="cartButton" type="button" aria-label="Cart">
        <span class="cart-icon">ðŸ‘œ</span>
        <span class="cart-count" id="cartCount" style="display:none;">0</span>
      </button>
    </nav>
  </header>

  <section class="product-detail">
    <div class="product-detail-inner">

      <div class="product-image">
        <img src="../images/Cashmere-kisses-body-butter.jpg" alt="Cashmere Kisses">
      </div>

      <div class="product-info">
        <h1>Cashmere Kisses</h1>
        <div class="product-type">Body Butter</div>

        <p class="product-desc">
          A soft, cozy blend that feels like your favorite cashmere sweater on the skin â€” smoothing,
          comforting, and perfect for everyday luxury.
        </p>

        <!-- âœ… Your sections FIRST -->
        <div class="product-sections">
          <details open>
            <summary>Benefits</summary>
            <p>
              â€¢ Cushions dry skin with rich, creamy moisture.<br>
              â€¢ Adds a soft, comforting scent that hugs the skin.<br>
              â€¢ Helps improve the look and feel of rough areas over time.
            </p>
          </details>

          <details>
            <summary>Ingredients</summary>
            <p>
              59.5% Distilled Water, Glycerin, Jojoba Oil, Shea Butter, Mango Butter, Cocoa Butter,
              Cetyl Alcohol, BTMS-50, Liquid Germall Plus, Fragrance/Essential Oil.
            </p>
          </details>

          <details>
            <summary>How to Use</summary>
            <p>Apply from neck to toes after bathing, or anytime you want that soft-cashmere feel.</p>
          </details>
        </div>

        <!-- âœ… Then the buy area -->
        <div class="dn-buybox">
          <div class="dn-price" id="dnPrice">$â€”</div>

          <div class="dn-sizes" id="dnSizes"></div>

          <div class="dn-row">
            <input class="dn-qty" id="dnQty" type="number" min="1" value="1" />
            <button class="dn-add" id="dnAdd" type="button" disabled>Add to cart</button>
            <a href="../shop-body-butter.html" class="outline-btn">Back</a>
          </div>

          <div class="dn-note" id="dnNote">Select a size to see price.</div>

          <!-- Hidden mount: we still mount Shopify product component (for data + consistency) -->
          <div id="product-component-1771275419576" style="display:none;"></div>
        </div>
      </div>

    </div>
  </section>

  <footer class="footer">
    <p>Â© 2026 D'NATURAL BODY</p>
    <p>Email: dnaturalbody@outlook.com</p>
  </footer>

  <div id="shopify-cart-toggle" style="display:none;"></div>
  <script src="../buybutton.js"></script>

  <script>
    (function () {
      var PRODUCT_ID = '14889665036653'; // Cashmere Kisses product id
      var selectedVariantGid = null;
      var selectedVariantTitle = '';
      var selectedPrice = null;

      var priceEl = document.getElementById('dnPrice');
      var sizesEl = document.getElementById('dnSizes');
      var qtyEl = document.getElementById('dnQty');
      var addBtn = document.getElementById('dnAdd');
      var noteEl = document.getElementById('dnNote');

      function formatMoney(amountStr) {
        // amountStr like "8.00" from Storefront API
        var n = Number(amountStr);
        if (!Number.isFinite(n)) return '$â€”';
        return '$' + n.toFixed(2);
      }

      function renderSizes(variants) {
        sizesEl.innerHTML = '';
        variants.forEach(function (v, idx) {
          var title = (v.title || '').trim(); // e.g. "2oz"
          var btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'dn-chip';
          btn.textContent = title;
          btn.setAttribute('aria-pressed', 'false');

          btn.addEventListener('click', function () {
            // set pressed state
            Array.prototype.forEach.call(sizesEl.querySelectorAll('.dn-chip'), function (b) {
              b.setAttribute('aria-pressed', 'false');
            });
            btn.setAttribute('aria-pressed', 'true');

            selectedVariantGid = v.id; // gid://shopify/ProductVariant/...
            selectedVariantTitle = title;
            selectedPrice = v.price && v.price.amount ? v.price.amount : null;

            priceEl.textContent = formatMoney(selectedPrice);
            addBtn.disabled = false;
            noteEl.textContent = 'Selected: ' + selectedVariantTitle;
          });

          // auto-select first variant
          if (idx === 0) {
            setTimeout(function () { btn.click(); }, 0);
          }

          sizesEl.appendChild(btn);
        });
      }

      function addToCart() {
        var qty = Math.max(1, parseInt(qtyEl.value, 10) || 1);

        if (!window.DNShopify || !window.DNShopify.cart || !selectedVariantGid) return;

        addBtn.disabled = true;
        addBtn.textContent = 'Addingâ€¦';

        // Buy Button cart expects { variantId: <gid>, quantity: <number> }
        window.DNShopify.cart.addLineItems([
          { variantId: selectedVariantGid, quantity: qty }
        ]).then(function () {
          addBtn.textContent = 'Add to cart';
          addBtn.disabled = false;

          if (window.DNShopify.openCart) window.DNShopify.openCart();
        }).catch(function () {
          addBtn.textContent = 'Add to cart';
          addBtn.disabled = false;
          noteEl.textContent = 'Could not add item. Please try again.';
        });
      }

      addBtn.addEventListener('click', addToCart);

      function mountAndFetch() {
        // Ensure DNShopify is ready
        if (!window.DNShopify || !window.DNShopify.client) {
          return setTimeout(mountAndFetch, 80);
        }

        // (Optional) Mount hidden product component (not displayed)
        if (window.DNShopify.mountProduct) {
          window.DNShopify.mountProduct({
            id: PRODUCT_ID,
            node: '#product-component-1771275419576',
            options: { cart: { popup: false } }
          });
        }

        // Fetch variants + prices via Storefront client
        window.DNShopify.client.product.fetch(PRODUCT_ID).then(function (product) {
          if (!product || !product.variants || !product.variants.length) {
            noteEl.textContent = 'No variants found.';
            return;
          }

          // Build a clean list of variants with price
          var variants = product.variants.map(function (v) {
            return {
              id: v.id,
              title: v.title,
              price: v.priceV2 || { amount: v.price, currencyCode: 'USD' }
            };
          });

          renderSizes(variants);
        }).catch(function () {
          noteEl.textContent = 'Could not load pricing. Please refresh.';
        });
      }

      mountAndFetch();
    })();
  </script>

</body>
</html>
