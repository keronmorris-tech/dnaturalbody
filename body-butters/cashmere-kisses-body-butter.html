<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Cashmere Kisses | D'NATURAL BODY</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles.css">

  <style>
    /* Hide Shopify Buy Button built-in UI inside this component (we render our own) */
    #product-component-1771275419576 .shopify-buy__product__variant-selectors,
    #product-component-1771275419576 .shopify-buy__option-select-wrapper,
    #product-component-1771275419576 select.shopify-buy__option-select__select,
    #product-component-1771275419576 .shopify-buy__product__price,
    #product-component-1771275419576 .shopify-buy__product__actual-price,
    #product-component-1771275419576 .shopify-buy__product__compare-price,
    #product-component-1771275419576 .shopify-buy__btn {
      display: none !important;
    }
  </style>
</head>

<body class="product-body">
  <header class="header">
    <a href="../index.html" class="logo">
      <img src="../images/logo.png" alt="D'NATURAL BODY Logo">
    </a>

    <nav class="main-nav">
      <a href="../index.html" class="nav-link">Home</a>

      <div class="nav-item dropdown">
        <a href="../shop.html" class="nav-link">Shop â–¾</a>
        <div class="dropdown-menu">
          <a href="../shop.html">View All</a>
          <a href="../shop-body-butter.html">Body Butter</a>
          <a href="../shop-body-scrub.html">Body Scrub</a>
          <a href="../shop-body-yogurt.html">Body Yogurt</a>
        </div>
      </div>

      <a href="../about.html" class="nav-link">About</a>
      <a href="../contact.html" class="nav-link">Contact</a>

      <button class="cart-button" id="cartButton" type="button" aria-label="Cart">
        <span class="cart-icon">ðŸ‘œ</span>
        <span class="cart-count" id="cartCount" style="display:none;">0</span>
      </button>
    </nav>
  </header>

  <section class="product-detail">
    <div class="product-detail-inner">

      <div class="product-image">
        <img src="../images/Cashmere-kisses-body-butter.jpg" alt="Cashmere Kisses">
      </div>

      <div class="product-info">
        <h1>Cashmere Kisses</h1>
        <div class="product-type">Body Butter</div>

        <!-- Dynamic price updates when size changes -->
        <div class="price" id="dnPriceTop">$â€”</div>

        <p class="product-desc">
          A soft, cozy blend that feels like your favorite cashmere sweater on the skin â€” smoothing,
          comforting, and perfect for everyday luxury.
        </p>

        <!-- DETAILS FIRST -->
        <div class="product-sections">
          <details open>
            <summary>Benefits</summary>
            <p>
              â€¢ Cushions dry skin with rich, creamy moisture.<br>
              â€¢ Adds a soft, comforting scent that hugs the skin.<br>
              â€¢ Helps improve the look and feel of rough areas over time.
            </p>
          </details>

          <details>
            <summary>Ingredients</summary>
            <p>
              59.5% Distilled Water, Glycerin, Jojoba Oil, Shea Butter, Mango Butter, Cocoa Butter,
              Cetyl Alcohol, BTMS-50, Liquid Germall Plus, Fragrance/Essential Oil.
            </p>
          </details>

          <details>
            <summary>How to Use</summary>
            <p>Apply from neck to toes after bathing, or anytime you want that soft-cashmere feel.</p>
          </details>
        </div>

        <!-- BUY AREA -->
        <div class="dn-buybox">
          <div class="dn-label">Size</div>
          <div class="dn-sizes" id="dnSizes"></div>

          <div class="dn-label">Quantity</div>
          <div class="dn-qtywrap" aria-label="Quantity selector">
            <button class="dn-qtybtn" id="dnMinus" type="button" aria-label="Decrease quantity">âˆ’</button>
            <div class="dn-qtynum" id="dnQty">1</div>
            <button class="dn-qtybtn" id="dnPlus" type="button" aria-label="Increase quantity">+</button>
          </div>

          <div class="dn-actions">
            <button class="dn-add" id="dnAdd" type="button" disabled>Add to cart</button>
            <a href="../shop-body-butter.html" class="outline-btn">Back</a>
          </div>

          <div class="dn-note" id="dnNote">Select a size to see price.</div>

          <!-- Hidden mount keeps Shopify cart system consistent -->
          <div id="product-component-1771275419576" style="display:none;"></div>
        </div>
      </div>

    </div>
  </section>

  <footer class="footer">
    <p>Â© 2026 D'NATURAL BODY</p>
    <p>Email: dnaturalbody@outlook.com</p>
  </footer>

  <div id="shopify-cart-toggle" style="display:none;"></div>
  <script src="../buybutton.js"></script>

  <script>
    (function () {
      var PRODUCT_ID = '14889665036653'; // Cashmere Kisses product id

      var selectedVariantGid = null;
      var selectedVariantTitle = '';
      var selectedVariantPrice = null;
      var selectedCurrency = 'CAD';
      var qty = 1;

      var priceTopEl = document.getElementById('dnPriceTop');
      var sizesEl = document.getElementById('dnSizes');
      var addBtn = document.getElementById('dnAdd');
      var noteEl = document.getElementById('dnNote');
      var qtyEl = document.getElementById('dnQty');
      var minusBtn = document.getElementById('dnMinus');
      var plusBtn = document.getElementById('dnPlus');

      function formatMoney(amountStr, currencyCode) {
        var n = Number(amountStr);
        var c = currencyCode || 'CAD';
        if (!Number.isFinite(n)) return '$â€”';
        try {
          return new Intl.NumberFormat('en-CA', { style: 'currency', currency: c }).format(n);
        } catch (e) {
          return '$' + n.toFixed(2) + ' ' + c;
        }
      }

      function setQty(newQty) {
        qty = Math.max(1, newQty);
        qtyEl.textContent = String(qty);
      }

      minusBtn.addEventListener('click', function () { setQty(qty - 1); });
      plusBtn.addEventListener('click', function () { setQty(qty + 1); });

      function renderSizes(variants) {
        sizesEl.innerHTML = '';

        variants.forEach(function (v, idx) {
          var title = (v.title || '').trim();
          var btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'dn-chip';
          btn.textContent = title;
          btn.setAttribute('aria-pressed', 'false');

          btn.addEventListener('click', function () {
            Array.prototype.forEach.call(sizesEl.querySelectorAll('.dn-chip'), function (b) {
              b.setAttribute('aria-pressed', 'false');
            });
            btn.setAttribute('aria-pressed', 'true');

            selectedVariantGid = v.id;
            selectedVariantTitle = title;
            selectedVariantPrice = v.price && v.price.amount ? v.price.amount : null;
            selectedCurrency = (v.price && v.price.currencyCode) ? v.price.currencyCode : (selectedCurrency || 'CAD');

            priceTopEl.textContent = formatMoney(selectedVariantPrice, selectedCurrency);
            addBtn.disabled = false;
            noteEl.textContent = 'Selected: ' + selectedVariantTitle;
          });

          sizesEl.appendChild(btn);

          if (idx === 0) setTimeout(function () { btn.click(); }, 0);
        });
      }

      function addToCart() {
        if (!window.DNShopify || !window.DNShopify.cart || !selectedVariantGid) return;

        addBtn.disabled = true;
        addBtn.textContent = 'Addingâ€¦';

        window.DNShopify.cart.addLineItems([
          { variantId: selectedVariantGid, quantity: qty }
        ]).then(function () {
          addBtn.textContent = 'Add to cart';
          addBtn.disabled = false;
          if (window.DNShopify.openCart) window.DNShopify.openCart();
        }).catch(function () {
          addBtn.textContent = 'Add to cart';
          addBtn.disabled = false;
          noteEl.textContent = 'Could not add item. Please try again.';
        });
      }

      addBtn.addEventListener('click', addToCart);

      function mountAndFetch() {
        if (!window.DNShopify || !window.DNShopify.client) {
          return setTimeout(mountAndFetch, 80);
        }

        if (window.DNShopify.mountProduct) {
          window.DNShopify.mountProduct({
            id: PRODUCT_ID,
            node: '#product-component-1771275419576',
            options: { cart: { popup: false } }
          });
        }

        window.DNShopify.client.product.fetch(PRODUCT_ID).then(function (product) {
          if (!product || !product.variants || !product.variants.length) {
            noteEl.textContent = 'No variants found.';
            return;
          }

          var variants = product.variants.map(function (v) {
            var p = v.priceV2 || { amount: v.price, currencyCode: 'CAD' };
            return { id: v.id, title: v.title, price: p };
          });

          renderSizes(variants);
        }).catch(function () {
          noteEl.textContent = 'Could not load pricing. Please refresh.';
        });
      }

      setQty(1);
      mountAndFetch();
    })();
  </script>

</body>
</html>
