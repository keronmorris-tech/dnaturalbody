<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Berry Boujee | D'NATURAL BODY</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles.css">
  <style>

    /* Hide Shopify Buy Button built-in UI inside this component (we render our own) */
    #product-component-14889683222893 .shopify-buy__product__variant-selectors,
    #product-component-14889683222893 .shopify-buy__option-select-wrapper,
    #product-component-14889683222893 select.shopify-buy__option-select__select,
    #product-component-14889683222893 .shopify-buy__product__price,
    #product-component-14889683222893 .shopify-buy__product__actual-price,
    #product-component-14889683222893 .shopify-buy__product__compare-price,
    #product-component-14889683222893 .shopify-buy__btn {
      display: none !important;
    }

    /* Custom buy box (size chips + qty + add) */
    .dn-buybox { margin-top: 18px; border-top: 1px solid rgba(0,0,0,0.08); padding-top: 16px; }
    .dn-label { font-family: 'Montserrat', sans-serif; font-size: 13px; color: rgba(0,0,0,0.65); margin: 10px 0 8px 0; }
    .dn-sizes { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 14px; }
    .dn-chip {
      font-family: 'Montserrat', sans-serif; font-size: 14px;
      padding: 10px 18px; border-radius: 999px; border: 1px solid rgba(0,0,0,0.25);
      background: #fff; color: #0b0a0a; cursor: pointer; user-select: none;
      transition: transform 0.05s ease, background 0.2s ease;
    }
    .dn-chip:active { transform: scale(0.98); }
    .dn-chip[aria-pressed="true"] { background: #0b0a0a; color: #fff; border-color: #0b0a0a; font-weight: 700; }
    .dn-chip[disabled] { opacity: 0.45; cursor: not-allowed; }

    .dn-qtywrap {
      display: inline-flex; align-items: center;
      border: 1px solid rgba(0,0,0,0.25); border-radius: 10px; overflow: hidden;
      margin-bottom: 14px; background: #fff;
    }
    .dn-qtybtn { width: 44px; height: 42px; border: 0; background: transparent; font-size: 18px; cursor: pointer; color: #0b0a0a; }
    .dn-qtynum {
      width: 54px; height: 42px; display: grid; place-items: center;
      font-family: 'Montserrat', sans-serif; font-weight: 700; color: #0b0a0a;
      border-left: 1px solid rgba(0,0,0,0.15); border-right: 1px solid rgba(0,0,0,0.15);
    }
    .dn-actions { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
    .dn-add {
      background: #1d201c; color: #fff; border: none; padding: 14px 18px; border-radius: 10px;
      font-family: 'Montserrat', sans-serif; font-weight: 700; cursor: pointer; min-width: 170px;
    }
    .dn-add:hover { background: #313630; }
    .dn-add:disabled { opacity: 0.6; cursor: not-allowed; }
    .dn-note { font-family: 'Montserrat', sans-serif; font-size: 13px; color: rgba(0,0,0,0.65); margin-top: 8px; }

  </style>
</head>

<body class="product-body">
  <header class="header">
    <a href="../index.html" class="logo">
      <img src="../images/logo.png" alt="D'NATURAL BODY Logo">
    </a>

    <nav class="main-nav">
      <a href="../index.html" class="nav-link">Home</a>

      <div class="nav-item dropdown">
        <a href="../shop.html" class="nav-link">Shop â–¾</a>
        <div class="dropdown-menu">
          <a href="../shop.html">View All</a>
          <a href="../shop-body-butter.html">Body Butter</a>
          <a href="../shop-body-scrub.html">Body Scrub</a>
          <a href="../shop-body-yogurt.html">Body Yogurt</a>
        </div>
      </div>

      <a href="../about.html" class="nav-link">About</a>
      <a href="../contact.html" class="nav-link">Contact</a>

      <button class="cart-button" id="cartButton" type="button" aria-label="Cart">
        <span class="cart-icon">ðŸ‘œ</span>
        <span class="cart-count" id="cartCount" style="display:none;">0</span>
      </button>
    </nav>
  </header>

  <section class="product-detail">
    <div class="product-detail-inner">

      <div class="product-image">
        <img src="../images/Berry-Boujee-body-scrub.jpg" alt="Berry Boujee">
      </div>

      <div class="product-info">
        <h1>Berry Boujee</h1>
        <div class="product-type">Body Scrub</div>

        <!-- Dynamic price updates when size changes -->
        <div class="price" id="dnPriceTop">$â€”</div>

        <p class="product-desc">A juicy, sugar-based exfoliating scrub that gently buffs away dull skin,
          leaving your body soft, hydrated, and smelling like a berry-filled treat.</p>

        <!-- DETAILS FIRST -->
        <div class="product-sections">
<details open>
  <summary>Benefits</summary>
  <p>Benefits<br/>This creamy body scrub exfoliates without stripping moisture,<br/>            leaving skin smooth, nourished, and glowing after every use.</p>
</details>

<details>
  <summary>Ingredients</summary>
  <p>Ingredients<br/>Sugar, Glycerin, Shea Butter, Jojoba Oil, Fragrance,<br/>            and a gentle preservative system to keep your scrub fresh.</p>
</details>

<details>
  <summary>How to Use</summary>
  <p>How to Use<br/>Massage onto damp skin in circular motions, focusing on rough areas.<br/>            Rinse thoroughly and follow with body yogurt or body butter for extra glow.<br/>            Use 2â€“3 times a week.</p>
</details>
        </div>

        <!-- BUY AREA -->
        <div class="dn-buybox">
          <div class="dn-label">Size</div>
          <div class="dn-sizes" id="dnSizes"></div>

          <div class="dn-label">Quantity</div>
          <div class="dn-qtywrap" aria-label="Quantity selector">
            <button class="dn-qtybtn" id="dnMinus" type="button" aria-label="Decrease quantity">âˆ’</button>
            <div class="dn-qtynum" id="dnQty">1</div>
            <button class="dn-qtybtn" id="dnPlus" type="button" aria-label="Increase quantity">+</button>
          </div>

          <div class="dn-actions">
            <button class="dn-add" id="dnAdd" type="button" disabled>Add to cart</button>
            <a href="../shop-body-scrub.html" class="outline-btn">Back</a>
          </div>

          <div class="dn-note" id="dnNote">Select a size to see price.</div>

          <!-- Hidden mount keeps Shopify cart system consistent -->
          <div id="product-component-14889683222893" style="display:none;"></div>
        </div>
      </div>

    </div>
  </section>

  <footer class="footer">
    <p>Â© 2026 D'NATURAL BODY</p>
    <p>Email: dnaturalbody@outlook.com</p>
  </footer>

  <div id="shopify-cart-toggle" style="display:none;"></div>
  <script src="../buybutton.js"></script>

  <script>
    (function () {
      var PRODUCT_NUMERIC_ID = "14889683222893";
      var PRODUCT_GID = "gid://shopify/Product/" + PRODUCT_NUMERIC_ID;

      var STORE_DOMAIN = "dpscr1-vz.myshopify.com";
      var STOREFRONT_TOKEN = "b6634d4da21c44f64244a1ff19a52d78";
      var GRAPHQL_URL = "https://" + STORE_DOMAIN + "/api/2024-07/graphql.json";

      var selectedVariantGid = null;
      var selectedVariantTitle = "";
      var selectedPrice = null;
      var selectedCurrency = "CAD";
      var qty = 1;

      var priceTopEl = document.getElementById("dnPriceTop");
      var sizesEl = document.getElementById("dnSizes");
      var addBtn = document.getElementById("dnAdd");
      var noteEl = document.getElementById("dnNote");
      var qtyEl = document.getElementById("dnQty");
      var minusBtn = document.getElementById("dnMinus");
      var plusBtn = document.getElementById("dnPlus");

      function formatMoney(amountStr, currencyCode) {
        var n = Number(amountStr);
        var c = currencyCode || "CAD";
        if (!Number.isFinite(n)) return "$â€”";
        try {
          return new Intl.NumberFormat("en-CA", { style: "currency", currency: c }).format(n);
        } catch (e) {
          return "$" + n.toFixed(2) + " " + c;
        }
      }

      function setQty(newQty) {
        qty = Math.max(1, newQty);
        qtyEl.textContent = String(qty);
      }

      minusBtn.addEventListener("click", function () { setQty(qty - 1); });
      plusBtn.addEventListener("click", function () { setQty(qty + 1); });

      function setSelected(v, btn) {
        Array.prototype.forEach.call(sizesEl.querySelectorAll(".dn-chip"), function (b) {
          b.setAttribute("aria-pressed", "false");
        });
        if (btn) btn.setAttribute("aria-pressed", "true");

        selectedVariantGid = v.id;
        selectedVariantTitle = (v.title || "").trim();
        selectedPrice = v.price && v.price.amount ? v.price.amount : null;
        selectedCurrency = (v.price && v.price.currencyCode) ? v.price.currencyCode : (selectedCurrency || "CAD");

        priceTopEl.textContent = formatMoney(selectedPrice, selectedCurrency);
        addBtn.disabled = !v.availableForSale;
        noteEl.textContent = v.availableForSale ? ("Selected: " + selectedVariantTitle) : ("Sold out: " + selectedVariantTitle);
      }

      function renderSizes(variants) {
        sizesEl.innerHTML = "";

        variants.forEach(function (v, idx) {
          var btn = document.createElement("button");
          btn.type = "button";
          btn.className = "dn-chip";
          btn.textContent = (v.title || "").trim();
          btn.setAttribute("aria-pressed", "false");
          if (!v.availableForSale) btn.setAttribute("disabled", "disabled");

          btn.addEventListener("click", function () {
            if (!v.availableForSale) return;
            setSelected(v, btn);
          });

          sizesEl.appendChild(btn);

          if (idx === 0) {
            // auto-select first AVAILABLE variant
            if (v.availableForSale) setTimeout(function () { btn.click(); }, 0);
          }
        });

        // If first was sold out, select the first available
        if (!selectedVariantGid) {
          var firstAvail = variants.find(function(x){ return x.availableForSale; });
          if (firstAvail) {
            var firstBtn = Array.prototype.slice.call(sizesEl.querySelectorAll(".dn-chip")).find(function(b){
              return (b.textContent || "").trim() === (firstAvail.title || "").trim() && !b.disabled;
            });
            if (firstBtn) firstBtn.click();
          } else {
            noteEl.textContent = "Sold out.";
            addBtn.disabled = true;
          }
        }
      }

      function addToCart() {
        if (!window.DNShopify || !window.DNShopify.cart || !selectedVariantGid) return;

        addBtn.disabled = true;
        addBtn.textContent = "Addingâ€¦";

        window.DNShopify.cart.addLineItems([
          { variantId: selectedVariantGid, quantity: qty }
        ]).then(function () {
          addBtn.textContent = "Add to cart";
          addBtn.disabled = false;
          if (window.DNShopify.openCart) window.DNShopify.openCart();
        }).catch(function () {
          addBtn.textContent = "Add to cart";
          addBtn.disabled = false;
          noteEl.textContent = "Could not add item. Please try again.";
        });
      }

      addBtn.addEventListener("click", addToCart);

      function fetchVariants() {
        var query = `
          query($id: ID!) {
            product(id: $id) {
              variants(first: 50) {
                edges {
                  node {
                    id
                    title
                    availableForSale
                    priceV2 { amount currencyCode }
                  }
                }
              }
            }
          }
        `;

        return fetch(GRAPHQL_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-Shopify-Storefront-Access-Token": STOREFRONT_TOKEN
          },
          body: JSON.stringify({ query: query, variables: { id: PRODUCT_GID } })
        }).then(function (r) { return r.json(); });
      }

      function mountWhenReady() {
        if (!window.DNShopify || !window.DNShopify.client) return setTimeout(mountWhenReady, 80);

        // hidden mount keeps buy-button cart system consistent
        if (window.DNShopify.mountProduct) {
          window.DNShopify.mountProduct({
            id: PRODUCT_NUMERIC_ID,
            node: "#product-component-14889683222893",
            options: { cart: { popup: false } }
          });
        }

        fetchVariants().then(function (data) {
          var edges = data && data.data && data.data.product && data.data.product.variants && data.data.product.variants.edges;
          if (!edges || !edges.length) {
            noteEl.textContent = "No variants found.";
            return;
          }

          var variants = edges.map(function (e) {
            var n = e.node || {};
            return {
              id: n.id,
              title: n.title,
              availableForSale: !!n.availableForSale,
              price: n.priceV2 || { amount: null, currencyCode: "CAD" }
            };
          });

          renderSizes(variants);
        }).catch(function () {
          noteEl.textContent = "Could not load pricing. Please refresh.";
        });
      }

      setQty(1);
      mountWhenReady();
    })();
  </script>


</body>
</html>